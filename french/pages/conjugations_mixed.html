<!DOCTYPE html>
<html lang="fr">

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Présent Simple</title>

    <link rel="icon" type="image/x-icon" href="../images/eiffel-tower.ico">
    <link rel="stylesheet" href="../styles.css">

    <script type="module">
        "use strict";

        import { PageBuilderForManyTenses } from '../js/PageBuilderForManyTenses.mjs';
        import { Resolver } from '../js/Resolver.mjs';
        import { ErrorCounter } from '../js/ErrorCounter.mjs';
        import { Config } from '../js/Config.mjs';

        const verbListObject = PageBuilderForManyTenses.getVerbList();
        const title = window.decodeURIComponent(window.location.search).substring(1);

        if (Resolver.map[title] === undefined) {
            document.getElementById('checkboxes-to-choose-tenses').style.display = 'block';
        }

        let page = window.location.pathname.split('/').pop() + window.location.search;

        document.querySelectorAll('.verb-tense-checkbox').forEach((checkboxElement) => {
            checkboxElement.checked = Config.retrieve(page, checkboxElement.name) ?? true;

            checkboxElement.onclick = () => {
                Config.save(page, checkboxElement.name, checkboxElement.checked);

                PageBuilderForManyTenses.buildForManyTenses(verbListObject, title);
                ErrorCounter.initialize(PageBuilderForManyTenses.getVerbTenseList());
            }
        });

        PageBuilderForManyTenses.buildForManyTenses(verbListObject, title);

        ErrorCounter.initialize(PageBuilderForManyTenses.getVerbTenseList(title));
    </script>
</head>


<body>
    <main spellcheck="false">
        <article class="verb-list-mixed-tenses">
            <header>
                <h3 id="page-title">Temps de conjugaison</h3>

                <span id="checkboxes-to-choose-tenses">
                    <label>
                        <input type="checkbox" class="verb-tense-checkbox" name="present" checked="checked">Le présent
                    </label>
                    <label>
                        <input type="checkbox" class="verb-tense-checkbox" name="presentperfect" checked="checked">Le
                        passé
                        composé
                    </label>
                    <label>
                        <input type="checkbox" class="verb-tense-checkbox" name="imperfect"
                            checked="checked">L'imparfait
                    </label>
                    <label>
                        <input type="checkbox" class="verb-tense-checkbox" name="future" checked="checked">Le futur
                        simple
                    </label>
                    <label>
                        <input type="checkbox" class="verb-tense-checkbox" name="pastperfect" checked="checked">Le
                        plus-que-parfait
                    </label>
                    <label>
                        <input type="checkbox" class="verb-tense-checkbox" name="conditionalpresent"
                            checked="checked">Le
                        conditionnel présent
                    </label>
                    <label>
                        <input type="checkbox" class="verb-tense-checkbox" name="presentsubjunctive"
                            checked="checked">Le
                        subjonctif présent
                    </label>
                    <label>
                        <input type="checkbox" class="verb-tense-checkbox" name="conditionalperfect"
                            checked="checked">Le
                        conditionnel passé
                    </label>
                    <label>
                        <input type="checkbox" class="verb-tense-checkbox" name="imperative"
                            checked="checked">L'impératif
                    </label>
                </span>
                <h4>Conjuguez ces <span id="number-of-verbs"></span> verbes.</h4>
            </header>

            <div id="verb-list"></div>

            <template id="template-verb-block">
                <div class="verb-block">
                    <hr />
                    <h4 class="infinitive"></h4>
                </div>
            </template>

            <template id="template-conjugations-for-one-tense-block">
                <div class="conjugations-for-one-tense-block">
                    <h4 class="tense"></h4>
                </div>
            </template>

            <template id="template-input">
                <div class="conjugation-line">
                    <label class="pronoun"></label>
                    <input type="text" />
                    <span class="speakerphone">
                        <audio></audio>
                        <svg width="20" height="20" viewBox="0 0 24 24" focusable="false" class=" NMm5M">
                            <path
                                d="M3 9v6h4l5 5V4L7 9H3zm7-.17v6.34L7.83 13H5v-2h2.83L10 8.83zM16.5 12A4.5 4.5 0 0 0 14 7.97v8.05c1.48-.73 2.5-2.25 2.5-4.02z">
                            </path>
                            <path
                                d="M14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77 0-4.28-2.99-7.86-7-8.77z">
                            </path>
                        </svg>
                    </span>
                </div>
            </template>

            <iframe src="partials/errorCounter.html"
                onload="this.before(...(this.contentWindow.document.body||this.contentWindow.document).children);this.remove()"></iframe>

        </article>
    </main>
</body>

</html>